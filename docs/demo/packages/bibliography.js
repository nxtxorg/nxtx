var nxtx_bibliography=function(){"use strict";const t={};let e=[];const n=document.createElement("style");n.id="bibliography-style-block",document.head.appendChild(n),n.sheet.insertRule(".bib-entry { margin-bottom: 5px }",0),n.sheet.insertRule(".bib-entry span { margin-right: 5px }",1);const r={author:t=>{const e=t.value.split(" and ").map(t=>{const e=t.split(",");e.length>1&&(t=e[1].trim()+" "+e[0]);const n=t.split(" ").filter(t=>t[0]===t[0].toUpperCase()),r=n[n.length-1];return n.length-=1,n.map(t=>t[0]+".").join(" ")+" "+r}).join(", ");return nxtx.html("span",{class:"bib bib-author"},e+".")},year:t=>nxtx.html("span",{class:"bib bib-year"},`(${t.value}).`),title:t=>nxtx.html("span",{class:"bib bib-title"},`“${t.value}”.`),url:t=>nxtx.html("a",{class:"bib bib-url",href:t.value,target:"_blank"},t.value),isbn:t=>nxtx.html("span",{class:"bib bib-isbn"},`ISBN: ${t.value}.`)};nxtx.on("prerender",()=>e=[]);const a={name:"basic-formatting",commands:{cite:async(...t)=>{const n=t.flatMap(t=>{let n=e.indexOf(t.value);-1===n&&(e.push(t.value),n=e.length-1);const r=nxtx.htmlLite("a",{href:`#---${t.value}`});return r.innerText=n+1,[r,", "]});return n.length-=1,nxtx.html("span",null,"[",...n,"]")},"bib-print":async()=>{const n=e.map(e=>t[e]||console.warn(`Bibliography entry '${e}' not found`)).filter(t=>!!t);if(0===n.length)return;const a=n.map((t,n)=>nxtx.html("div",{id:`---${e[n]}`,class:"bib bib-entry"},nxtx.html("span",{class:"bib bib-ordering"},`[${n+1}]`),...Object.keys(r).filter(e=>void 0!==t[e]).map(e=>r[e](t[e]))));return[{type:nxtx.TYPE.COMMAND,name:"pagebreak",args:[]},nxtx.html("h2",{class:"bibliography"},"Bibliography"),...a]}},preprocessors:{"bib-add":(e,n)=>{if(!n||n.type!==nxtx.TYPE.DICTIONARY)return console.error("bib-add only must have a dictionary as second argument");t[e.value]=n.value}}};return nxtx&&(Object.keys(a.commands).forEach(t=>nxtx.registerCommand(t,a.commands[t])),Object.keys(a.preprocessors).forEach(t=>nxtx.registerPreprocessor(t,a.preprocessors[t]))),a}();
//# sourceMappingURL=bibliography.js.map
