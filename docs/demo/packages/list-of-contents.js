!function(){"use strict";let e={},t={},n=[],l={};const s=document.createElement("style");s.id="basic-formatting-style-block",document.head.appendChild(s);[["chapter","h1"],["section","h3"],["subsection","h4"]].forEach(l=>((l,s)=>{e[l]=0,t={...e},nxtx.registerPreprocessor(l,e=>{t[l]+=1,a(l),n.push({type:l,title:e.value,numbering:{...t}})}),nxtx.registerCommand(l,e=>nxtx.html(s,null,e.value))})(...l)),nxtx.registerPreprocessor("label",e=>{console.log("label"),void 0!==l[e.value]?console.warn(`Attempt to redefine label '${e.value}' ignored`):l[e.value]=n.length&&n[n.length-1]}),nxtx.registerCommand("label",e=>nxtx.html("span",{id:"--"+e.value,"data-label":e.value}));const a=e=>{const n=Object.keys(t);let l=!1;for(let s=0;s<n.length;s++)l?t[n[s]]=0:n[s]===e&&(l=!0)},r=e=>Object.keys(e).map(t=>e[t]).join(".").replace(/[.0]+$/,""),o=(e,t)=>{const n=l[e];if(!n)return console.warn(`Label '${e}' has not been referenced`),nxtx.html("b",{class:"warning"},`${e}`);let s="";switch(n.type){case"chapter":s=`chapter ${r(n.numbering)}`;break;case"section":case"subsection":s=`section ${r(n.numbering)}`}return t?(e=>e[0].toUpperCase()+e.substr(1))(s):s};nxtx.registerCommand("ref",e=>nxtx.html("a",{href:`#--${e.value}`,"data-ref":e.value},o(e.value,!1))),nxtx.registerCommand("Ref",e=>nxtx.html("a",{href:`#--${e.value}`,"data-ref":e.value},o(e.value,!0))),nxtx.registerCommand("loc-print",()=>{return[nxtx.html("h2",{class:"list-of-contents"},"List of Contents"),...n.map(e=>nxtx.html("div",{class:`loc-${e.type}`},`${r(e.numbering)} ${e.title}`)),{type:nxtx.TYPE.COMMAND,name:"pagebreak",args:[]}]}),nxtx.on("postrender",()=>{t={...e},n=[],l={}}),s.sheet.insertRule(".loc-chapter { font-size: 14pt }",0),s.sheet.insertRule(".loc-section { font-size: 13pt; padding-left: 2em }",1),s.sheet.insertRule(".loc-subsection { font-size: 12pt; padding-left: 4em }",2)}();
//# sourceMappingURL=list-of-contents.js.map
